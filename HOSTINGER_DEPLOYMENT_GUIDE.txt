# ============================================
# Hostinger Business Plan - Deployment Guide
# ============================================
# For GitHub-based deployments to Hostinger
# ============================================

## Prerequisites
- Hostinger Business Plan (or higher) with Node.js support
- Node.js 20.x enabled in hPanel
- GitHub repository connected to Hostinger

## Quick Start (Recommended)

### 1. Connect GitHub to Hostinger
1. Log in to Hostinger hPanel
2. Go to: Websites → [Your Domain] → Manage
3. Navigate to: Advanced → Node.js
4. Click "Connect to GitHub Repository"
5. Authorize and select your repository

### 2. Configure Node.js Application
In hPanel → Node.js section, set:
```
Node.js Version:    20.x
Application Root:   / (root directory)
Entry Point:        index.js
Build Command:      npm run build
Start Command:      npm start
```

### 3. Add Environment Variables
In hPanel → Node.js → Environment Variables:
```
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://...
SUPABASE_URL=https://...
SUPABASE_SERVICE_ROLE_KEY=eyJ...
SESSION_SECRET=your-secure-secret-32-chars
FRONTEND_URL=https://yourdomain.com
PAYSTACK_PUBLIC_KEY=pk_live_...
PAYSTACK_SECRET_KEY=sk_live_...
```

### 4. Deploy
1. Click "Deploy" in hPanel
2. Wait for build to complete (2-5 minutes)
3. Your app is live!

## How It Works
- Push to `main` branch triggers auto-deploy
- GitHub Actions builds the app
- Hostinger pulls and runs the build
- `index.js` loads environment and starts server

## File Structure
```
/
├── index.js              ← Entry point (loads env, starts server)
├── package.json          ← npm scripts
├── .htaccess             ← Apache config for SPA routing
├── .nvmrc                ← Node version
├── dist/
│   ├── server/
│   │   └── index.js      ← Compiled server
│   └── public/
│       ├── index.html    ← React app
│       └── assets/       ← Static files
└── node_modules/
```

## Troubleshooting

### App Not Starting
1. Check Node.js logs in hPanel
2. Verify environment variables are set
3. Ensure DATABASE_URL is correct
4. Check if port 3000 is available

### Database Connection Failed
```
# Verify your DATABASE_URL format:
postgresql://user:password@host:port/database?sslmode=require
```

### Build Failed
1. Check GitHub Actions workflow log
2. Run locally: `npm run build`
3. Fix any TypeScript or build errors

### 504 Gateway Timeout
1. Check server logs for errors
2. Verify database is reachable
3. Increase request timeout if needed

### Frontend Not Loading (Blank Page)
1. Check dist/public/index.html exists
2. Verify .htaccess is in dist/public/
3. Clear browser cache

## Manual Deployment (SSH)

If needed, deploy manually via SSH:
```bash
ssh username@yourdomain.com
cd public_html

# Pull latest code
git pull origin main

# Install dependencies
npm ci --legacy-peer-deps

# Build
npm run build

# Restart (if using PM2)
pm2 restart all

# Or start fresh
npm start
```

## Performance Tips
1. Enable CloudFlare CDN
2. Monitor memory usage in hPanel
3. Set up uptime monitoring
4. Enable gzip compression (already in .htaccess)

## Support
- Hostinger Help: https://www.hostinger.com/help
- Check server logs in hPanel → Node.js → Logs
